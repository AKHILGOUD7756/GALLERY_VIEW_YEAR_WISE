<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gallery - Single File with No-Image Fallback</title>

<!-- Optional: Bootstrap for grid & basic styles -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    :root{
        --primary-blue: #1e3c72;
        --secondary-blue: #2a5298;
        --accent-red: #e70422;
        --muted: #f7f7f7;
    }

    body{
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: #f3f6fb;
        color: #222;
        padding: 24px 12px;
    }

    .container-wrap{
        max-width: 1200px;
        margin: 0 auto;
    }

    .gallery-title{
        display:inline-block;
        font-size: 26px;
        font-weight: 700;
        border-bottom: 4px solid var(--primary-blue);
        padding-bottom: 8px;
        margin-bottom: 22px;
    }

    /* Year buttons */
    #yearButtons {
        display:flex;
        flex-wrap:wrap;
        justify-content:center;
        gap:10px;
        margin: 18px 0 30px;
    }
    .year-btn {
        padding: 10px 26px;
        font-size:16px;
        border-radius: 38px;
        border: none;
        background: linear-gradient(135deg,var(--primary-blue),var(--secondary-blue));
        color: #fff;
        font-weight:600;
        cursor:pointer;
        transition: transform .18s ease, box-shadow .18s ease, opacity .18s ease;
    }
    .year-btn:hover{ transform: translateY(-3px); box-shadow: 0 8px 20px rgba(34,50,90,0.12); }
    .year-btn.active-year { background: linear-gradient(135deg, #ff4d4d, #e70422); }

    /* Content area (folders or images) */
    #contentArea { margin-top: 10px; }

    .folder-box, .img-box {
        height: 260px;
        border-radius: 14px;
        overflow: hidden;
        position: relative;
        background-color: #fff;
        display:flex;
        align-items:center;
        justify-content:center;
        transition: transform .18s ease, box-shadow .18s ease;
        cursor: pointer;
        border: 1px solid rgba(0,0,0,0.06);
    }
    .folder-box:hover, .img-box:hover{ transform: translateY(-6px); box-shadow: 0 10px 26px rgba(34,50,90,0.08); }

    .folder-overlay{
        position:absolute;
        left:0; right:0; bottom:0;
        background: linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.65) 100%);
        color:#fff;
        padding: 10px 12px;
        font-weight:600;
        text-align:center;
    }

    .folder-bg{
        position:absolute; inset:0; background-size:cover; background-position:center; filter: saturate(.95) contrast(.98);
    }

    .img-box img{
        width:100%;
        height:100%;
        object-fit:cover;
        display:block;
    }

    .back-row{
        display:flex;
        gap:12px;
        align-items:center;
        justify-content: center;
        margin-bottom: 18px;
    }
    .back-btn {
        padding:10px 20px;
        border-radius: 44px;
        border:none;
        cursor:pointer;
        background: linear-gradient(135deg,#007bff,#0056b3);
        color:white;
        font-weight:600;
        transition: transform .15s ease, box-shadow .15s ease;
    }
    .back-btn:hover{ transform: translateY(-3px); box-shadow: 0 6px 18px rgba(0,80,180,0.18); }

    .section-title{
        font-size: 22px;
        font-weight:700;
        margin-right: 12px;
        padding-left: 10px;
        border-left: 4px solid orange;
        display:flex;
        align-items:center;
        height: 48px;
    }

    /* Placeholder card styling when no images */
    .no-images-card{
        height: 260px;
        border-radius: 14px;
        background: linear-gradient(180deg,#fff,#f2f6fb);
        border: 1px dashed rgba(0,0,0,0.06);
        display:flex;
        align-items:center;
        justify-content:center;
        flex-direction:column;
        gap:10px;
        color: #6b7280;
    }

    /* Responsive grid tweaks */
    @media (min-width: 992px){
        .col-lg-custom { flex: 0 0 24%; max-width: 24%; }
    }
    @media (max-width: 991px){
        .folder-box, .img-box { height: 220px; }
    }
    @media (max-width: 576px){
        .folder-box, .img-box { height: 180px; }
    }
</style>
</head>
<body>

<div class="container-wrap">

    <header class="d-flex align-items-center justify-content-between mb-3">
        <div class="d-flex align-items-center">
            <h1 class="gallery-title">Gallery</h1>
        </div>
    </header>

    <!-- Year buttons -->
    <div id="yearButtons" role="tablist" aria-label="Gallery Years">
        <!-- Buttons inserted by JS -->
    </div>

    <!-- Content area (folders or images) -->
    <div id="contentArea" class="row g-4"></div>

</div>

<script>
/* ----------------- CONFIG ----------------- */
/* Placeholder image to use when original missing */
const PLACEHOLDER = "https://via.placeholder.com/800x600?text=No+Image+Available";

/* Data (folders & thumbnails) */
const data = {
    "2024-25": [
        { title: "Festival Celebration", folder: "2024/festival", bgImage: "https://images.unsplash.com/photo-1511895426328-dc8714191300?auto=format&fit=crop&w=900&q=60" },
        { title: "Sports Events", folder: "2024/games", bgImage: "https://images.unsplash.com/photo-1546519638-68e109498ffc?auto=format&fit=crop&w=900&q=60" },
        { title: "Dance Performance", folder: "2024/dance", bgImage: "https://images.unsplash.com/photo-1547153760-18fc86324498?auto=format&fit=crop&w=900&q=60" },
        { title: "Onam Celebration", folder: "2024/onam", bgImage: "https://images.unsplash.com/photo-1594736797933-d0ea3ff8db41?auto=format&fit=crop&w=900&q=60" },
        { title: "Sankranthi Festival", folder: "2024/sakranthi", bgImage: "https://images.unsplash.com/photo-1577095720565-6ce5d61d0380?auto=format&fit=crop&w=900&q=60" },
        { title: "Dussehra Festival", folder: "2024/dhasara1", bgImage: "https://images.unsplash.com/photo-1603383928972-0d6b0c98b0ad?auto=format&fit=crop&w=900&q=60" }
    ],
    "2023-24": [
        { title: "Annual Sports Day", folder: "2023/sports", bgImage: "https://images.unsplash.com/photo-1461896836934-ffe607ba8211?auto=format&fit=crop&w=900&q=60" },
        { title: "Annual Day Function", folder: "2023/annual", bgImage: "https://images.unsplash.com/photo-1492684223066-81342ee5ff30?auto=format&fit=crop&w=900&q=60" }
    ],
    "2022-23": [
        { title: "School Events", folder: "2022/events", bgImage: "https://images.unsplash.com/photo-1540575467063-178a50c2df87?auto=format&fit=crop&w=900&q=60" }
    ],
    "2021-22": [
        { title: "Memories Gallery", folder: "2021/gallery", bgImage: "https://images.unsplash.com/photo-1523050854058-8df90110c9f1?auto=format&fit=crop&w=900&q=60" }
    ]
};

/* Images inside each folder — can be empty, missing, or contain many images */
const images = {
    "2024/festival": [
        { src: "https://images.unsplash.com/photo-1511895426328-dc8714191300?auto=format&fit=crop&w=900&q=60", text: "School Annual Festival" },
        { src: "https://images.unsplash.com/photo-1531058020387-3be344556be6?auto=format&fit=crop&w=900&q=60", text: "Cultural Dance" },
        // imagine more here (if missing or broken, fallback will be used)
    ],
    "2024/games": [
        { src: "https://images.unsplash.com/photo-1546519638-68e109498ffc?auto=format&fit=crop&w=900&q=60" },
        { src: "https://invalid-url.example.com/missing.jpg" } // intentionally broken to demo fallback
    ],
    "2024/dance": [
        /* empty folder example can be simulated by commenting-out or making [] */
    ],
    "2024/onam": [
        { src: "https://images.unsplash.com/photo-1594736797933-d0ea3ff8db41?auto=format&fit=crop&w=900&q=60" }
    ],
    "2023/sports": [
        { src: "https://images.unsplash.com/photo-1461896836934-ffe607ba8211?auto=format&fit=crop&w=900&q=60" },
        { src: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=900&q=60" },
        // pretend up to 20 images...
    ],
    "2021/gallery": [
        // simulate no images uploaded yet
    ]
};

/* ---------- Runtime logic ---------- */

const yearButtonsContainer = document.getElementById("yearButtons");
const contentArea = document.getElementById("contentArea");

/* Initialize year buttons */
function initYearButtons(){
    const years = Object.keys(data);
    years.forEach((y, idx) => {
        const btn = document.createElement("button");
        btn.className = "year-btn" + (idx===0 ? " active-year" : "");
        btn.textContent = y;
        btn.type = "button";
        btn.addEventListener("click", () => loadFolders(y, btn));
        yearButtonsContainer.appendChild(btn);
    });
}

/* Load folder cards for a year */
function loadFolders(year, btnElement){
    // set active
    document.querySelectorAll(".year-btn").forEach(b => b.classList.remove("active-year"));
    btnElement.classList.add("active-year");

    // clear area
    contentArea.innerHTML = "";

    const folders = data[year] || [];
    if(!folders.length){
        contentArea.innerHTML = `<div class="col-12"><div class="no-images-card"><div>No folders found for ${year}</div></div></div>`;
        return;
    }

    folders.forEach(item => {
        const col = document.createElement("div");
        col.className = "col-12 col-md-6 col-lg-custom";

        const box = document.createElement("div");
        box.className = "folder-box";
        box.setAttribute("tabindex","0");
        box.style.minHeight = "200px";

        const bg = document.createElement("div");
        bg.className = "folder-bg";
        bg.style.backgroundImage = `url('${item.bgImage || PLACEHOLDER}')`;
        box.appendChild(bg);

        const overlay = document.createElement("div");
        overlay.className = "folder-overlay";
        overlay.textContent = item.title || "Folder";
        box.appendChild(overlay);

        box.addEventListener("click", () => loadImages(item.folder, item.title));
        col.appendChild(box);
        contentArea.appendChild(col);
    });
}

/* Load images for folder. If folder missing or empty, show placeholder card */
function loadImages(folderKey, title){
    const imgs = images[folderKey] || [];

    contentArea.innerHTML = "";

    // Top controls: title + back button
    const topCol = document.createElement("div");
    topCol.className = "col-12";

    const topRow = document.createElement("div");
    topRow.className = "back-row";

    const sectionTitle = document.createElement("div");
    sectionTitle.className = "section-title";
    sectionTitle.textContent = title || folderKey;

    const backBtn = document.createElement("button");
    backBtn.className = "back-btn";
    backBtn.type = "button";
    backBtn.innerHTML = "← Back to Folders";
    backBtn.addEventListener("click", () => {
        // find currently active year and reload folders view
        const active = document.querySelector(".year-btn.active-year");
        const yearText = active ? active.textContent.trim() : Object.keys(data)[0];
        loadFolders(yearText, active || document.querySelector(".year-btn"));
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    topRow.appendChild(sectionTitle);
    topRow.appendChild(backBtn);
    topCol.appendChild(topRow);
    contentArea.appendChild(topCol);

    if(!imgs.length){
        // show no images placeholder
        const col = document.createElement("div");
        col.className = "col-12 col-md-6 col-lg-custom";
        col.innerHTML = `
            <div class="no-images-card">
                <img src="${PLACEHOLDER}" alt="No Image" style="max-width:260px;border-radius:8px;box-shadow:0 8px 20px rgba(0,0,0,0.06)">
                <div><strong>No images uploaded yet</strong></div>
                <div style="font-size:13px;color:#9aa0a6">Please upload images to the folder "${folderKey}"</div>
            </div>
        `;
        contentArea.appendChild(col);
        return;
    }

    // render images grid
    imgs.forEach((imgObj, idx) => {
        const col = document.createElement("div");
        col.className = "col-12 col-md-6 col-lg-custom";

        const imgBox = document.createElement("div");
        imgBox.className = "img-box";

        // image element
        const image = document.createElement("img");
        image.loading = "lazy";
        image.alt = imgObj.text || `Image ${idx+1}`;
        image.src = imgObj.src || PLACEHOLDER;

        // fallback handler (prevents infinite loop if placeholder fails)
        image.onerror = function(){
            if(this.dataset.fallbackUsed) return;
            this.dataset.fallbackUsed = "1";
            this.src = PLACEHOLDER;
        };

        // click to open in new tab / lightbox - simple behavior
        image.addEventListener("click", () => {
            window.open(image.src, "_blank");
        });

        imgBox.appendChild(image);
        col.appendChild(imgBox);
        contentArea.appendChild(col);
    });

    // scroll to top of content
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* init */
initYearButtons();
loadFolders(Object.keys(data)[0], document.querySelector(".year-btn"));

</script>

</body>
</html>
